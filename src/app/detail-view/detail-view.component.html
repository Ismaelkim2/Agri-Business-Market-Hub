<app-sidebar></app-sidebar>

<div class="container">
  <div class="d-flex justify-content-between align-items-center mb-4">
    <div (click)="goBack()" class="back-icon mt-3">
      <i class="fa fa-arrow-left text-dark fs-4" title="Go Back"></i>
    </div>
    <h2 class="text-center text-success mt-2">{{ cardType | titlecase }} Analysis</h2>
  </div>

  <div class="graph-container my-4">
    <canvas id="graphCanvas"></canvas>
  </div>

  <div *ngIf="cardType === 'sales'" class="summary-section">
    <h3 class="text-center text-success mb-3">Sales Summary</h3>
    <div class="table-responsive">
      <table class="table table-hover table-bordered shadow-sm">
        <thead class="bg-success text-white">
          <tr>
            <th>Category</th>
            <th>Amount</th>
            <th>Percentage</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let data of salesRecord">
            <td>{{ data.birdType }}</td>
            <td>{{ data.sales | currency: 'KES' }}</td>
            <td>{{ (data.sales / totalSales) * 100 | number: '1.0-2' }}%</td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>

  <div *ngIf="cardType === 'birds'" class="summary-section">
    <h3 class="text-center text-success mb-3">Bird Records</h3>
    <div class="table-responsive">
      <table class="table table-hover table-bordered shadow-sm">
        <thead class="bg-primary text-white">
          <tr>
            <th>Bird Category</th>
            <th>Count</th>
            <th>Percentage</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let record of birdRecords">
            <td>{{ record.birdType }}</td>
            <td>{{ record.count }}</td>
            <td>{{ calculatePercentage(record.count, record.totalBirds) }}%</td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>
  
  

  <div *ngIf="cardType === 'expense'" class="summary-section">
    <h3 class="text-center text-success mb-3">Expense Records</h3>
    <div class="table-responsive">
      <table class="table table-hover table-bordered shadow-sm">
        <thead class="bg-warning text-dark">
          <tr>
            <th>Category</th>
            <th>Amount</th>
            <th>Percentage</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let record of expensesRecord">
            <td>{{ record.expenseType }}</td>
            <td>{{ record.amount }}</td>
            <td>{{ (record.amount / totalExpenses )*100 | number:'1.0-2' }}%</td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>

  <div *ngIf="cardType === 'profit'" class="summary-section">
    <h3 class="text-center text-success mb-3">Profit Records</h3>
    <div class="table-responsive">
      <table class="table table-hover table-bordered shadow-sm">
        <thead class="bg-info text-white">
          <tr>
            <th>Sales</th>
            <th>Expense</th>
            <th>Profit</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let record of salesRecord">
            <td>{{ record.salesAmount | currency: 'KES' }}</td>
            <td>{{ record.expenses | currency: 'KES' }}</td>
            <td>{{ (record?.salesAmount || 0) - (record?.expenses || 0) | currency: 'KES' }}</td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>
</div>
